<!DOCTYPE html>
<html>
<head>
  <title>Relive Anxiety</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
      font-family: system-ui, sans-serif;
    }
    canvas {
      display: block;
      margin: auto;
    }
  </style>
</head>
<body>
<canvas id="c"></canvas>
<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
// Shorts resolution
canvas.width = 720;
canvas.height = 1280;
// Box
const box = {
  x: 40,
  y: 140,
  w: canvas.width - 80,
  h: canvas.height - 280
};
// Ball
let ball = {
  x: box.x + box.w / 2,
  y: box.y + box.h / 2,
  vx: (Math.random() - 0.5) * 20,
  vy: (Math.random() - 0.5) * 20,
  r: 8,
  hue: Math.random() * 360
};
// Gravity
let gravityAngle = Math.random() * Math.PI * 2;
let gravityStrength = 0.35;
let time = 0;

// ðŸŽµ Enhanced calming ambient audio
let audioStarted = false;
let audioCtx, oscillators = [], gains = [];

function startAudio() {
  if (audioStarted) return;
  audioStarted = true;
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  
  // Create a calming chord progression with multiple oscillators
  // Using frequencies that create a peaceful atmosphere
  const frequencies = [
    130.81, // C3
    164.81, // E3
    196.00, // G3
    261.63  // C4
  ];
  
  frequencies.forEach((freq, i) => {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    
    osc.type = "sine";
    osc.frequency.value = freq;
    gain.gain.value = 0.03; // Quiet, ambient volume
    
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    
    oscillators.push(osc);
    gains.push(gain);
    
    // Add subtle frequency modulation for organic feel
    setInterval(() => {
      const variation = (Math.random() - 0.5) * 2;
      osc.frequency.linearRampToValueAtTime(
        freq + variation,
        audioCtx.currentTime + 6
      );
    }, 6000 + i * 1000);
  });
  
  // Add a deep bass drone for grounding
  const bass = audioCtx.createOscillator();
  const bassGain = audioCtx.createGain();
  bass.type = "sine";
  bass.frequency.value = 65.41; // C2
  bassGain.gain.value = 0.04;
  bass.connect(bassGain);
  bassGain.connect(audioCtx.destination);
  bass.start();
  
  oscillators.push(bass);
  gains.push(bassGain);
}

window.addEventListener("click", startAudio);
window.addEventListener("touchstart", startAudio);

function drawBorder() {
  ctx.strokeStyle = "white";
  ctx.lineWidth = 3;
  ctx.strokeRect(box.x, box.y, box.w, box.h);
}

function drawText() {
  ctx.fillStyle = "white";
  ctx.textAlign = "center";
  ctx.font = "bold 44px sans-serif";
  ctx.fillText("STAY HERE", canvas.width / 2, 60);
  ctx.font = "28px sans-serif";
  ctx.fillText("TO RELIVE ANXIETY", canvas.width / 2, 100);
}

function loop() {
  requestAnimationFrame(loop);
  time += 0.01;
  // Soft trail fade
  ctx.fillStyle = "rgba(0,0,0,0.20)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  // Gravity pulses + rotates
  gravityAngle += Math.sin(time * 0.7) * 0.01;
  gravityStrength = 0.3 + Math.sin(time * 0.9) * 0.15;
  const gx = Math.cos(gravityAngle) * gravityStrength;
  const gy = Math.sin(gravityAngle) * gravityStrength;
  ball.vx += gx;
  ball.vy += gy;
  ball.x += ball.vx;
  ball.y += ball.vy;
  // Wall collisions
  if (ball.x - ball.r < box.x) {
    ball.x = box.x + ball.r;
    ball.vx *= -0.95;
    ball.hue += 40;
  }
  if (ball.x + ball.r > box.x + box.w) {
    ball.x = box.x + box.w - ball.r;
    ball.vx *= -0.95;
    ball.hue += 40;
  }
  if (ball.y - ball.r < box.y) {
    ball.y = box.y + ball.r;
    ball.vy *= -0.95;
    ball.hue += 40;
  }
  if (ball.y + ball.r > box.y + box.h) {
    ball.y = box.y + box.h - ball.r;
    ball.vy *= -0.95;
    ball.hue += 40;
  }
  // Gentle speed creep
  ball.vx *= 1.001;
  ball.vy *= 1.001;
  ball.vx = Math.max(-24, Math.min(24, ball.vx));
  ball.vy = Math.max(-24, Math.min(24, ball.vy));
  // Glow
  ctx.shadowBlur = 30;
  ctx.shadowColor = `hsl(${ball.hue}, 100%, 60%)`;
  ctx.fillStyle = `hsl(${ball.hue}, 100%, 60%)`;
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
  ctx.fill();
  ctx.shadowBlur = 0;
  drawBorder();
  drawText();
}
loop();
</script>
</body>
</html>
